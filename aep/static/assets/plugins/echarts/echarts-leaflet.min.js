!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("echarts/lib/echarts"),require("leaflet/src/Leaflet")):"function"==typeof define&&define.amd?define(["exports","echarts/lib/echarts","leaflet/src/Leaflet"],t):t((e=e||self).leaflet={},e.echarts,e.L)}(this,function(e,t,o){"use strict";var n="default"in t?t.default:t;function a(e,t){this._map=e,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=t,this._projection=o.Projection.Mercator}function r(e,t,o,n){var a=o.leafletModel,r=o.seriesModel,i=a?a.coordinateSystem:r?r.coordinateSystem||(r.getReferringComponents("leaflet")[0]||{}).coordinateSystem:null;return i===this?i[e](n):null}o=o&&o.hasOwnProperty("default")?o.default:o,a.prototype.dimensions=["lng","lat"],a.prototype.setZoom=function(e){this._zoom=e},a.prototype.setCenter=function(e){this._center=this._projection.project(new o.LatLng(e[1],e[0]))},a.prototype.setMapOffset=function(e){this._mapOffset=e},a.prototype.getLeaflet=function(){return this._map},a.prototype.dataToPoint=function(e){var t=new o.LatLng(e[1],e[0]),n=this._map.latLngToLayerPoint(t),a=this._mapOffset;return[n.x-a[0],n.y-a[1]]},a.prototype.pointToData=function(e){var t=this._mapOffset,o=this._map.layerPointToLatLng({x:e[0]+t[0],y:e[1]+t[1]});return[o.lng,o.lat]},a.prototype.convertToPixel=t.util.curry(r,"dataToPoint"),a.prototype.convertFromPixel=t.util.curry(r,"pointToData"),a.prototype.getViewRect=function(){var e=this._api;return new t.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())},a.prototype.getRoamTransform=function(){return t.matrix.create()},a.dimensions=a.prototype.dimensions;var i=o.Layer.extend({initialize:function(e){this._container=e},onAdd:function(e){e.getPane(this.options.pane).appendChild(this._container)},onRemove:function(e){o.DomUtil.remove(this._container)},_update:function(){}});a.create=function(e,t){var n=void 0,r=[],l=t.getDom();return e.eachComponent("leaflet",function(e){var s=t.getZr().painter.getViewportRoot();if(void 0===o)throw new Error("Leaflet api is not loaded");if(n)throw new Error("Only one leaflet component can exist");if(!e.__map){var p=l.querySelector(".ec-extension-leaflet");p&&(s.style.left="0px",s.style.top="0px",l.removeChild(p)),(p=document.createElement("div")).style.cssText="width:100%;height:100%",p.classList.add("ec-extension-leaflet"),l.appendChild(p);var f=e.__map=o.map(p),d=e.get("tiles"),c={},m=!1,u=!0,h=!1,y=void 0;try{for(var g,v=d[Symbol.iterator]();!(u=(g=v.next()).done);u=!0){var _=g.value,x=o.tileLayer(_.urlTemplate,_.options);_.label?(m||(x.addTo(f),m=!0),c[_.label]=x):x.addTo(f)}}catch(e){h=!0,y=e}finally{try{!u&&v.return&&v.return()}finally{if(h)throw y}}if(d.length>1){var C=e.get("layerControl");o.control.layers(c,{},C).addTo(f)}var L=document.createElement("div");L.style="position: relative;",L.appendChild(s),new i(L).addTo(f)}var Z=e.__map,b=e.get("center"),w=e.get("zoom");b&&w&&Z.setView([b[1],b[0]],w),n=new a(Z,t),r.push(n),n.setMapOffset(e.__mapOffset||[0,0]),n.setZoom(w),n.setCenter(b),e.coordinateSystem=n}),e.eachSeries(function(e){"leaflet"===e.get("coordinateSystem")&&(e.coordinateSystem=n)}),r},n.extendComponentModel({type:"leaflet",getLeaflet:function(){return this.__map},setCenterAndZoom:function(e,t){this.option.center=e,this.option.zoom=t},centerOrZoomChanged:function(e,t){var o,n,a=this.option;return o=e,n=a.center,!(o&&n&&o[0]===n[0]&&o[1]===n[1]&&t===a.zoom)},defaultOption:{center:[104.114129,37.550339],zoom:2,mapStyle:{},roam:!1,layerControl:{},tiles:[{urlTemplate:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",options:{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}}]}}),n.extendComponentView({type:"leaflet",render:function(e,t,o){var n=!0,a=e.getLeaflet(),r=o.getZr().painter.getViewportRoot().parentNode,i=e.coordinateSystem,l=function(t,l){if(!n){var s=a._mapPane,p=s.style.transform,f=0,d=0;if(p){var c=(p=p.replace("translate3d(","")).split(",");f=-parseInt(c[0],10),d=-parseInt(c[1],10)}else f=-parseInt(s.style.left,10),d=-parseInt(s.style.top,10);var m=[f,d];r.style.left=m[0]+"px",r.style.top=m[1]+"px",i.setMapOffset(m),e.__mapOffset=m,o.dispatchAction({type:"leafletRoam"})}};function s(){n||o.dispatchAction({type:"leafletRoam"})}function p(){l()}this._oldMoveHandler&&a.off("move",this._oldMoveHandler),this._oldZoomHandler&&a.off("zoom",this._oldZoomHandler),this._oldZoomEndHandler&&a.off("zoomend",this._oldZoomEndHandler),a.on("move",l),a.on("zoom",p),a.on("zoomend",s),this._oldMoveHandler=l,this._oldZoomHandler=p,this._oldZoomEndHandler=s;var f=e.get("roam");f&&"scale"!==f?a.dragging.enable():a.dragging.disable(),f&&"move"!==f?(a.scrollWheelZoom.enable(),a.doubleClickZoom.enable(),a.touchZoom.enable()):(a.scrollWheelZoom.disable(),a.doubleClickZoom.disable(),a.touchZoom.disable()),n=!1}}),n.registerCoordinateSystem("leaflet",a),n.registerAction({type:"leafletRoam",event:"leafletRoam",update:"updateLayout"},function(e,t){t.eachComponent("leaflet",function(e){var t=e.getLeaflet(),o=t.getCenter();e.setCenterAndZoom([o.lng,o.lat],t.getZoom())})});e.version="1.0.0",Object.defineProperty(e,"__esModule",{value:!0})});